function cov_nfvr6wtr5(){var path="C:\\capstone on friday\\Mess\\RMS\\server\\models\\royaltyModel.js";var hash="5553f32c2d7b8055048d36d0bf41be4cae6233d1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\capstone on friday\\Mess\\RMS\\server\\models\\royaltyModel.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:36}},"1":{start:{line:2,column:16},end:{line:2,column:49}},"2":{start:{line:3,column:13},end:{line:3,column:43}},"3":{start:{line:5,column:22},end:{line:15,column:2}},"4":{start:{line:18,column:0},end:{line:33,column:5}},"5":{start:{line:19,column:4},end:{line:31,column:5}},"6":{start:{line:20,column:6},end:{line:30,column:7}},"7":{start:{line:21,column:8},end:{line:26,column:10}},"8":{start:{line:32,column:4},end:{line:32,column:11}},"9":{start:{line:36,column:0},end:{line:36,column:69}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:18,column:26},end:{line:18,column:27}},loc:{start:{line:18,column:48},end:{line:33,column:3}},line:18}},branchMap:{"0":{loc:{start:{line:19,column:4},end:{line:31,column:5}},type:"if",locations:[{start:{line:19,column:4},end:{line:31,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:19}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},f:{"0":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5553f32c2d7b8055048d36d0bf41be4cae6233d1"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_nfvr6wtr5=function(){return actualCoverage;};}return actualCoverage;}cov_nfvr6wtr5();const mongoose=(cov_nfvr6wtr5().s[0]++,require('mongoose'));const Royalty=(cov_nfvr6wtr5().s[1]++,require('../models/royaltyModel'));const Song=(cov_nfvr6wtr5().s[2]++,require('../models/songModel'));const RoyaltySchema=(cov_nfvr6wtr5().s[3]++,new mongoose.Schema({royaltyId:{type:String,required:true,unique:true},// e.g., "venu-krithik"
artistId:{type:mongoose.Schema.Types.ObjectId,ref:'Artist',required:true},songId:{type:mongoose.Schema.Types.ObjectId,ref:'Song',required:true},period:{type:String,default:Date.now},// e.g., "January 2025"
totalRoyalty:{type:Number,default:0},royaltyDue:{type:Number,default:0},royaltyPaid:{type:Number,default:0},totalStreams:{type:Number,default:0},// Streams counter
calculated_date:{type:Date,default:Date.now}// Last updated timestamp
}));cov_nfvr6wtr5().s[4]++;RoyaltySchema.pre("save",async function(next){cov_nfvr6wtr5().f[0]++;cov_nfvr6wtr5().s[5]++;if(this.isModified("totalRoyalty")){cov_nfvr6wtr5().b[0][0]++;cov_nfvr6wtr5().s[6]++;// Check if totalRoyalty is changed
try{cov_nfvr6wtr5().s[7]++;await Song.updateMany({_id:this.songId},// Use the formatted artistId (e.g., "venu-krithik")
{$set:{totalRoyalty:this.totalRoyalty}},// Sync totalRoyalty with Royalty module
{$set:{totalStreams:this.totalStreams}});}catch(error){}}else{cov_nfvr6wtr5().b[0][1]++;}cov_nfvr6wtr5().s[8]++;next();});cov_nfvr6wtr5().s[9]++;module.exports=mongoose.model('Royalty',RoyaltySchema,'Royalty');
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfbmZ2cjZ3dHI1IiwiYWN0dWFsQ292ZXJhZ2UiLCJtb25nb29zZSIsInMiLCJyZXF1aXJlIiwiUm95YWx0eSIsIlNvbmciLCJSb3lhbHR5U2NoZW1hIiwiU2NoZW1hIiwicm95YWx0eUlkIiwidHlwZSIsIlN0cmluZyIsInJlcXVpcmVkIiwidW5pcXVlIiwiYXJ0aXN0SWQiLCJUeXBlcyIsIk9iamVjdElkIiwicmVmIiwic29uZ0lkIiwicGVyaW9kIiwiZGVmYXVsdCIsIkRhdGUiLCJub3ciLCJ0b3RhbFJveWFsdHkiLCJOdW1iZXIiLCJyb3lhbHR5RHVlIiwicm95YWx0eVBhaWQiLCJ0b3RhbFN0cmVhbXMiLCJjYWxjdWxhdGVkX2RhdGUiLCJwcmUiLCJuZXh0IiwiZiIsImlzTW9kaWZpZWQiLCJiIiwidXBkYXRlTWFueSIsIl9pZCIsIiRzZXQiLCJlcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2RlbCJdLCJzb3VyY2VzIjpbInJveWFsdHlNb2RlbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XHJcbmNvbnN0IFJveWFsdHkgPSByZXF1aXJlKCcuLi9tb2RlbHMvcm95YWx0eU1vZGVsJyk7XHJcbmNvbnN0IFNvbmcgPSByZXF1aXJlKCcuLi9tb2RlbHMvc29uZ01vZGVsJyk7XHJcblxyXG5jb25zdCBSb3lhbHR5U2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7XHJcbiAgICByb3lhbHR5SWQ6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSwgdW5pcXVlOiB0cnVlIH0sIC8vIGUuZy4sIFwidmVudS1rcml0aGlrXCJcclxuICAgIGFydGlzdElkOiB7IHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCwgcmVmOiAnQXJ0aXN0JywgcmVxdWlyZWQ6IHRydWUgfSxcclxuICAgIHNvbmdJZDogeyB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsIHJlZjogJ1NvbmcnLCByZXF1aXJlZDogdHJ1ZSB9LFxyXG4gICAgcGVyaW9kOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogRGF0ZS5ub3cgfSwgLy8gZS5nLiwgXCJKYW51YXJ5IDIwMjVcIlxyXG4gICAgdG90YWxSb3lhbHR5OiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxyXG4gICAgcm95YWx0eUR1ZTogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcclxuICAgIHJveWFsdHlQYWlkOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxyXG4gICAgdG90YWxTdHJlYW1zOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LCAvLyBTdHJlYW1zIGNvdW50ZXJcclxuICAgIGNhbGN1bGF0ZWRfZGF0ZTogeyB0eXBlOiBEYXRlLCBkZWZhdWx0OiBEYXRlLm5vdyB9IC8vIExhc3QgdXBkYXRlZCB0aW1lc3RhbXBcclxufSk7XHJcblxyXG5cclxuUm95YWx0eVNjaGVtYS5wcmUoXCJzYXZlXCIsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KSB7XHJcbiAgICBpZiAodGhpcy5pc01vZGlmaWVkKFwidG90YWxSb3lhbHR5XCIpKSB7IC8vIENoZWNrIGlmIHRvdGFsUm95YWx0eSBpcyBjaGFuZ2VkXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgU29uZy51cGRhdGVNYW55KFxyXG4gICAgICAgICAgeyBfaWQ6IHRoaXMuc29uZ0lkIH0sIC8vIFVzZSB0aGUgZm9ybWF0dGVkIGFydGlzdElkIChlLmcuLCBcInZlbnUta3JpdGhpa1wiKVxyXG4gICAgICAgICAgeyAkc2V0OiB7IHRvdGFsUm95YWx0eTogdGhpcy50b3RhbFJveWFsdHkgfSB9LCAvLyBTeW5jIHRvdGFsUm95YWx0eSB3aXRoIFJveWFsdHkgbW9kdWxlXHJcbiAgICAgICAgICB7ICRzZXQ6IHsgdG90YWxTdHJlYW1zOiB0aGlzLnRvdGFsU3RyZWFtcyB9IH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIG5leHQoKTtcclxuICB9KTtcclxuICBcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbW9uZ29vc2UubW9kZWwoJ1JveWFsdHknLCBSb3lhbHR5U2NoZW1hLCAnUm95YWx0eScpOyJdLCJtYXBwaW5ncyI6InVrREFlWTtBQUFBQSxhQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGFBQUEsR0FmWixLQUFNLENBQUFFLFFBQVEsRUFBQUYsYUFBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFDcEMsS0FBTSxDQUFBQyxPQUFPLEVBQUFMLGFBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsd0JBQXdCLENBQUMsRUFDakQsS0FBTSxDQUFBRSxJQUFJLEVBQUFOLGFBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMscUJBQXFCLENBQUMsRUFFM0MsS0FBTSxDQUFBRyxhQUFhLEVBQUFQLGFBQUEsR0FBQUcsQ0FBQSxNQUFHLEdBQUksQ0FBQUQsUUFBUSxDQUFDTSxNQUFNLENBQUMsQ0FDdENDLFNBQVMsQ0FBRSxDQUFFQyxJQUFJLENBQUVDLE1BQU0sQ0FBRUMsUUFBUSxDQUFFLElBQUksQ0FBRUMsTUFBTSxDQUFFLElBQUssQ0FBQyxDQUFFO0FBQzNEQyxRQUFRLENBQUUsQ0FBRUosSUFBSSxDQUFFUixRQUFRLENBQUNNLE1BQU0sQ0FBQ08sS0FBSyxDQUFDQyxRQUFRLENBQUVDLEdBQUcsQ0FBRSxRQUFRLENBQUVMLFFBQVEsQ0FBRSxJQUFLLENBQUMsQ0FDakZNLE1BQU0sQ0FBRSxDQUFFUixJQUFJLENBQUVSLFFBQVEsQ0FBQ00sTUFBTSxDQUFDTyxLQUFLLENBQUNDLFFBQVEsQ0FBRUMsR0FBRyxDQUFFLE1BQU0sQ0FBRUwsUUFBUSxDQUFFLElBQUssQ0FBQyxDQUM3RU8sTUFBTSxDQUFFLENBQUVULElBQUksQ0FBRUMsTUFBTSxDQUFFUyxPQUFPLENBQUVDLElBQUksQ0FBQ0MsR0FBSSxDQUFDLENBQUU7QUFDN0NDLFlBQVksQ0FBRSxDQUFFYixJQUFJLENBQUVjLE1BQU0sQ0FBRUosT0FBTyxDQUFFLENBQUUsQ0FBQyxDQUMxQ0ssVUFBVSxDQUFFLENBQUVmLElBQUksQ0FBRWMsTUFBTSxDQUFFSixPQUFPLENBQUUsQ0FBRSxDQUFDLENBQ3hDTSxXQUFXLENBQUUsQ0FBRWhCLElBQUksQ0FBRWMsTUFBTSxDQUFFSixPQUFPLENBQUUsQ0FBRSxDQUFDLENBQ3pDTyxZQUFZLENBQUUsQ0FBRWpCLElBQUksQ0FBRWMsTUFBTSxDQUFFSixPQUFPLENBQUUsQ0FBRSxDQUFDLENBQUU7QUFDNUNRLGVBQWUsQ0FBRSxDQUFFbEIsSUFBSSxDQUFFVyxJQUFJLENBQUVELE9BQU8sQ0FBRUMsSUFBSSxDQUFDQyxHQUFJLENBQUU7QUFDdkQsQ0FBQyxDQUFDLEVBQUN0QixhQUFBLEdBQUFHLENBQUEsTUFHSEksYUFBYSxDQUFDc0IsR0FBRyxDQUFDLE1BQU0sQ0FBRSxlQUFnQkMsSUFBSSxDQUFFLENBQUE5QixhQUFBLEdBQUErQixDQUFBLE1BQUEvQixhQUFBLEdBQUFHLENBQUEsTUFDNUMsR0FBSSxJQUFJLENBQUM2QixVQUFVLENBQUMsY0FBYyxDQUFDLENBQUUsQ0FBQWhDLGFBQUEsR0FBQWlDLENBQUEsU0FBQWpDLGFBQUEsR0FBQUcsQ0FBQSxNQUFFO0FBQ3JDLEdBQUksQ0FBQUgsYUFBQSxHQUFBRyxDQUFBLE1BQ0YsS0FBTSxDQUFBRyxJQUFJLENBQUM0QixVQUFVLENBQ25CLENBQUVDLEdBQUcsQ0FBRSxJQUFJLENBQUNqQixNQUFPLENBQUMsQ0FBRTtBQUN0QixDQUFFa0IsSUFBSSxDQUFFLENBQUViLFlBQVksQ0FBRSxJQUFJLENBQUNBLFlBQWEsQ0FBRSxDQUFDLENBQUU7QUFDL0MsQ0FBRWEsSUFBSSxDQUFFLENBQUVULFlBQVksQ0FBRSxJQUFJLENBQUNBLFlBQWEsQ0FBRSxDQUU5QyxDQUFDLENBRUgsQ0FBRSxNQUFPVSxLQUFLLENBQUUsQ0FFaEIsQ0FDRixDQUFDLEtBQUFyQyxhQUFBLEdBQUFpQyxDQUFBLFVBQUFqQyxhQUFBLEdBQUFHLENBQUEsTUFDRDJCLElBQUksQ0FBQyxDQUFDLENBQ1IsQ0FBQyxDQUFDLENBQUM5QixhQUFBLEdBQUFHLENBQUEsTUFHTG1DLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHckMsUUFBUSxDQUFDc0MsS0FBSyxDQUFDLFNBQVMsQ0FBRWpDLGFBQWEsQ0FBRSxTQUFTLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=