function cov_1fg988j4mj(){var path="C:\\Users\\Sudipta.Barua\\Downloads\\final project all things done without nodemodule\\final project all things done without nodemodule\\server\\songModule\\services\\songService.js";var hash="ee8f1bd13db7a3645c3b15a679d91b29fc21afd3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Sudipta.Barua\\Downloads\\final project all things done without nodemodule\\final project all things done without nodemodule\\server\\songModule\\services\\songService.js",statementMap:{"0":{start:{line:1,column:23},end:{line:1,column:64}},"1":{start:{line:2,column:22},end:{line:2,column:59}},"2":{start:{line:4,column:23},end:{line:4,column:43}},"3":{start:{line:8,column:4},end:{line:8,column:47}},"4":{start:{line:11,column:17},end:{line:11,column:63}},"5":{start:{line:13,column:4},end:{line:13,column:71}},"6":{start:{line:16,column:22},end:{line:16,column:84}},"7":{start:{line:17,column:23},end:{line:17,column:115}},"8":{start:{line:19,column:4},end:{line:19,column:32}},"9":{start:{line:23,column:4},end:{line:23,column:58}},"10":{start:{line:27,column:4},end:{line:27,column:67}},"11":{start:{line:31,column:4},end:{line:31,column:63}},"12":{start:{line:35,column:4},end:{line:35,column:68}},"13":{start:{line:40,column:17},end:{line:40,column:63}},"14":{start:{line:41,column:4},end:{line:41,column:49}},"15":{start:{line:41,column:15},end:{line:41,column:49}},"16":{start:{line:43,column:21},end:{line:43,column:34}},"17":{start:{line:45,column:24},end:{line:45,column:95}},"18":{start:{line:47,column:25},end:{line:47,column:74}},"19":{start:{line:50,column:4},end:{line:50,column:56}},"20":{start:{line:54,column:0},end:{line:54,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:2},end:{line:7,column:3}},loc:{start:{line:7,column:16},end:{line:9,column:3}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:10,column:2},end:{line:10,column:3}},loc:{start:{line:10,column:51},end:{line:20,column:3}},line:10},"2":{name:"(anonymous_2)",decl:{start:{line:22,column:2},end:{line:22,column:3}},loc:{start:{line:22,column:28},end:{line:24,column:3}},line:22},"3":{name:"(anonymous_3)",decl:{start:{line:26,column:2},end:{line:26,column:3}},loc:{start:{line:26,column:37},end:{line:28,column:3}},line:26},"4":{name:"(anonymous_4)",decl:{start:{line:30,column:2},end:{line:30,column:3}},loc:{start:{line:30,column:33},end:{line:32,column:3}},line:30},"5":{name:"(anonymous_5)",decl:{start:{line:34,column:2},end:{line:34,column:3}},loc:{start:{line:34,column:39},end:{line:36,column:3}},line:34},"6":{name:"(anonymous_6)",decl:{start:{line:38,column:2},end:{line:38,column:3}},loc:{start:{line:38,column:27},end:{line:51,column:3}},line:38}},branchMap:{"0":{loc:{start:{line:41,column:4},end:{line:41,column:49}},type:"if",locations:[{start:{line:41,column:4},end:{line:41,column:49}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:41}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ee8f1bd13db7a3645c3b15a679d91b29fc21afd3"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1fg988j4mj=function(){return actualCoverage;};}return actualCoverage;}cov_1fg988j4mj();const SongRepository=(cov_1fg988j4mj().s[0]++,require('../repositories/songRepository'));const RoyaltyService=(cov_1fg988j4mj().s[1]++,require('../services/royaltyService'));const royaltyService=(cov_1fg988j4mj().s[2]++,new RoyaltyService());class SongService{constructor(){cov_1fg988j4mj().f[0]++;cov_1fg988j4mj().s[3]++;this.songRepository=new SongRepository();// Dependency Injection
}async uploadSong(songData,artistName,songName){cov_1fg988j4mj().f[1]++;const song=(cov_1fg988j4mj().s[4]++,await this.songRepository.createSong(songData));// Add song to artist's songs
cov_1fg988j4mj().s[5]++;await this.songRepository.addSongToArtist(song.artistId,song._id);// Generate royalty and create entry
const royaltyId=(cov_1fg988j4mj().s[6]++,`${artistName}-${songName.toLowerCase().replace(/\s+/g,'-')}`);const newRoyalty=(cov_1fg988j4mj().s[7]++,await royaltyService.createRoyalty({royaltyId,artistId:song.artistId,songId:song._id}));cov_1fg988j4mj().s[8]++;return{song,newRoyalty};}async getSongById(songId){cov_1fg988j4mj().f[2]++;cov_1fg988j4mj().s[9]++;return await this.songRepository.findSongById(songId);}async getSongsByArtistId(artistId){cov_1fg988j4mj().f[3]++;cov_1fg988j4mj().s[10]++;return await this.songRepository.findSongsByArtistId(artistId);}async getSongsBySongId(songId){cov_1fg988j4mj().f[4]++;cov_1fg988j4mj().s[11]++;return await this.songRepository.findSongsBySongId(songId);}async updateSong(songId,updateData){cov_1fg988j4mj().f[5]++;cov_1fg988j4mj().s[12]++;return await this.songRepository.modifySong(songId,updateData);}async deleteSong(songId){cov_1fg988j4mj().f[6]++;// Get the song before deletion to ensure it's removed from Artist and Royalty
const song=(cov_1fg988j4mj().s[13]++,await this.songRepository.findSongById(songId));cov_1fg988j4mj().s[14]++;if(!song){cov_1fg988j4mj().b[0][0]++;cov_1fg988j4mj().s[15]++;throw new Error('Song not found');}else{cov_1fg988j4mj().b[0][1]++;}const artistId=(cov_1fg988j4mj().s[16]++,song.artistId);// Remove song from artist and delete royalty
const removedArtist=(cov_1fg988j4mj().s[17]++,await this.songRepository.removeSongFromArtist(song.artistId,song._id));const deletedroyalty=(cov_1fg988j4mj().s[18]++,await this.songRepository.deleteRoyalty(song._id));cov_1fg988j4mj().s[19]++;return await this.songRepository.removeSong(songId);}}cov_1fg988j4mj().s[20]++;module.exports=SongService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMWZnOTg4ajRtaiIsImFjdHVhbENvdmVyYWdlIiwiU29uZ1JlcG9zaXRvcnkiLCJzIiwicmVxdWlyZSIsIlJveWFsdHlTZXJ2aWNlIiwicm95YWx0eVNlcnZpY2UiLCJTb25nU2VydmljZSIsImNvbnN0cnVjdG9yIiwiZiIsInNvbmdSZXBvc2l0b3J5IiwidXBsb2FkU29uZyIsInNvbmdEYXRhIiwiYXJ0aXN0TmFtZSIsInNvbmdOYW1lIiwic29uZyIsImNyZWF0ZVNvbmciLCJhZGRTb25nVG9BcnRpc3QiLCJhcnRpc3RJZCIsIl9pZCIsInJveWFsdHlJZCIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsIm5ld1JveWFsdHkiLCJjcmVhdGVSb3lhbHR5Iiwic29uZ0lkIiwiZ2V0U29uZ0J5SWQiLCJmaW5kU29uZ0J5SWQiLCJnZXRTb25nc0J5QXJ0aXN0SWQiLCJmaW5kU29uZ3NCeUFydGlzdElkIiwiZ2V0U29uZ3NCeVNvbmdJZCIsImZpbmRTb25nc0J5U29uZ0lkIiwidXBkYXRlU29uZyIsInVwZGF0ZURhdGEiLCJtb2RpZnlTb25nIiwiZGVsZXRlU29uZyIsImIiLCJFcnJvciIsInJlbW92ZWRBcnRpc3QiLCJyZW1vdmVTb25nRnJvbUFydGlzdCIsImRlbGV0ZWRyb3lhbHR5IiwiZGVsZXRlUm95YWx0eSIsInJlbW92ZVNvbmciLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsic29uZ1NlcnZpY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU29uZ1JlcG9zaXRvcnkgPSByZXF1aXJlKCcuLi9yZXBvc2l0b3JpZXMvc29uZ1JlcG9zaXRvcnknKTtcclxuY29uc3QgUm95YWx0eVNlcnZpY2U9IHJlcXVpcmUoJy4uL3NlcnZpY2VzL3JveWFsdHlTZXJ2aWNlJyk7XHJcblxyXG5jb25zdCByb3lhbHR5U2VydmljZSA9IG5ldyBSb3lhbHR5U2VydmljZSgpO1xyXG5cclxuY2xhc3MgU29uZ1NlcnZpY2Uge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5zb25nUmVwb3NpdG9yeSA9IG5ldyBTb25nUmVwb3NpdG9yeSgpOyAvLyBEZXBlbmRlbmN5IEluamVjdGlvblxyXG4gIH1cclxuICBhc3luYyB1cGxvYWRTb25nKHNvbmdEYXRhLCBhcnRpc3ROYW1lLCBzb25nTmFtZSkge1xyXG4gICAgY29uc3Qgc29uZyA9IGF3YWl0IHRoaXMuc29uZ1JlcG9zaXRvcnkuY3JlYXRlU29uZyhzb25nRGF0YSk7XHJcbiAgICAvLyBBZGQgc29uZyB0byBhcnRpc3QncyBzb25nc1xyXG4gICAgYXdhaXQgdGhpcy5zb25nUmVwb3NpdG9yeS5hZGRTb25nVG9BcnRpc3Qoc29uZy5hcnRpc3RJZCwgc29uZy5faWQpO1xyXG5cclxuICAgIC8vIEdlbmVyYXRlIHJveWFsdHkgYW5kIGNyZWF0ZSBlbnRyeVxyXG4gICAgY29uc3Qgcm95YWx0eUlkID0gYCR7YXJ0aXN0TmFtZX0tJHtzb25nTmFtZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJy0nKX1gO1xyXG4gICAgY29uc3QgbmV3Um95YWx0eSA9IGF3YWl0IHJveWFsdHlTZXJ2aWNlLmNyZWF0ZVJveWFsdHkoeyByb3lhbHR5SWQsIGFydGlzdElkOiBzb25nLmFydGlzdElkLCBzb25nSWQ6IHNvbmcuX2lkIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4geyBzb25nLCBuZXdSb3lhbHR5IH07XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRTb25nQnlJZChzb25nSWQpIHtcclxuICAgIHJldHVybiBhd2FpdCB0aGlzLnNvbmdSZXBvc2l0b3J5LmZpbmRTb25nQnlJZChzb25nSWQpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0U29uZ3NCeUFydGlzdElkKGFydGlzdElkKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zb25nUmVwb3NpdG9yeS5maW5kU29uZ3NCeUFydGlzdElkKGFydGlzdElkKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFNvbmdzQnlTb25nSWQoc29uZ0lkKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zb25nUmVwb3NpdG9yeS5maW5kU29uZ3NCeVNvbmdJZChzb25nSWQpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgdXBkYXRlU29uZyhzb25nSWQsIHVwZGF0ZURhdGEpIHtcclxuICAgIHJldHVybiBhd2FpdCB0aGlzLnNvbmdSZXBvc2l0b3J5Lm1vZGlmeVNvbmcoc29uZ0lkLCB1cGRhdGVEYXRhKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGRlbGV0ZVNvbmcoc29uZ0lkKSB7XHJcbiAgICAvLyBHZXQgdGhlIHNvbmcgYmVmb3JlIGRlbGV0aW9uIHRvIGVuc3VyZSBpdCdzIHJlbW92ZWQgZnJvbSBBcnRpc3QgYW5kIFJveWFsdHlcclxuICAgIGNvbnN0IHNvbmcgPSBhd2FpdCB0aGlzLnNvbmdSZXBvc2l0b3J5LmZpbmRTb25nQnlJZChzb25nSWQpO1xyXG4gICAgaWYgKCFzb25nKSB0aHJvdyBuZXcgRXJyb3IoJ1Nvbmcgbm90IGZvdW5kJyk7XHJcblxyXG4gICAgY29uc3QgYXJ0aXN0SWQgPSBzb25nLmFydGlzdElkO1xyXG4gICAgLy8gUmVtb3ZlIHNvbmcgZnJvbSBhcnRpc3QgYW5kIGRlbGV0ZSByb3lhbHR5XHJcbiAgICBjb25zdCByZW1vdmVkQXJ0aXN0PWF3YWl0IHRoaXMuc29uZ1JlcG9zaXRvcnkucmVtb3ZlU29uZ0Zyb21BcnRpc3Qoc29uZy5hcnRpc3RJZCwgc29uZy5faWQpO1xyXG5cclxuICAgIGNvbnN0IGRlbGV0ZWRyb3lhbHR5PWF3YWl0IHRoaXMuc29uZ1JlcG9zaXRvcnkuZGVsZXRlUm95YWx0eShzb25nLl9pZCk7XHJcblxyXG4gICAgXHJcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5zb25nUmVwb3NpdG9yeS5yZW1vdmVTb25nKHNvbmdJZCk7XHJcbiAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFNvbmdTZXJ2aWNlO1xyXG4iXSwibWFwcGluZ3MiOiJtM0dBZVk7QUFBQUEsY0FBQSxTQUFBQSxDQUFBLFNBQUFD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