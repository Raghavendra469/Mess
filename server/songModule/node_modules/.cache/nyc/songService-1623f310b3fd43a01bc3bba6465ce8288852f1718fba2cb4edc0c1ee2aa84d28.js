function cov_2g1bbvxhs(){var path="C:\\final project all things done\\server\\songModule\\services\\songService.js";var hash="3ab15554ffd441856dcc7cbc9bd202679b8aa809";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\final project all things done\\server\\songModule\\services\\songService.js",statementMap:{"0":{start:{line:1,column:23},end:{line:1,column:64}},"1":{start:{line:2,column:22},end:{line:2,column:59}},"2":{start:{line:4,column:23},end:{line:4,column:43}},"3":{start:{line:8,column:4},end:{line:8,column:47}},"4":{start:{line:11,column:17},end:{line:11,column:63}},"5":{start:{line:13,column:4},end:{line:13,column:71}},"6":{start:{line:16,column:22},end:{line:16,column:84}},"7":{start:{line:17,column:23},end:{line:17,column:115}},"8":{start:{line:19,column:4},end:{line:19,column:32}},"9":{start:{line:23,column:4},end:{line:23,column:58}},"10":{start:{line:27,column:4},end:{line:27,column:67}},"11":{start:{line:31,column:4},end:{line:31,column:63}},"12":{start:{line:35,column:4},end:{line:35,column:68}},"13":{start:{line:40,column:17},end:{line:40,column:63}},"14":{start:{line:41,column:4},end:{line:41,column:49}},"15":{start:{line:41,column:15},end:{line:41,column:49}},"16":{start:{line:43,column:21},end:{line:43,column:34}},"17":{start:{line:45,column:24},end:{line:45,column:95}},"18":{start:{line:47,column:25},end:{line:47,column:74}},"19":{start:{line:50,column:4},end:{line:50,column:56}},"20":{start:{line:54,column:0},end:{line:54,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:2},end:{line:7,column:3}},loc:{start:{line:7,column:16},end:{line:9,column:3}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:10,column:2},end:{line:10,column:3}},loc:{start:{line:10,column:51},end:{line:20,column:3}},line:10},"2":{name:"(anonymous_2)",decl:{start:{line:22,column:2},end:{line:22,column:3}},loc:{start:{line:22,column:28},end:{line:24,column:3}},line:22},"3":{name:"(anonymous_3)",decl:{start:{line:26,column:2},end:{line:26,column:3}},loc:{start:{line:26,column:37},end:{line:28,column:3}},line:26},"4":{name:"(anonymous_4)",decl:{start:{line:30,column:2},end:{line:30,column:3}},loc:{start:{line:30,column:33},end:{line:32,column:3}},line:30},"5":{name:"(anonymous_5)",decl:{start:{line:34,column:2},end:{line:34,column:3}},loc:{start:{line:34,column:39},end:{line:36,column:3}},line:34},"6":{name:"(anonymous_6)",decl:{start:{line:38,column:2},end:{line:38,column:3}},loc:{start:{line:38,column:27},end:{line:51,column:3}},line:38}},branchMap:{"0":{loc:{start:{line:41,column:4},end:{line:41,column:49}},type:"if",locations:[{start:{line:41,column:4},end:{line:41,column:49}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:41}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3ab15554ffd441856dcc7cbc9bd202679b8aa809"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2g1bbvxhs=function(){return actualCoverage;};}return actualCoverage;}cov_2g1bbvxhs();const SongRepository=(cov_2g1bbvxhs().s[0]++,require('../repositories/songRepository'));const RoyaltyService=(cov_2g1bbvxhs().s[1]++,require('../services/royaltyService'));const royaltyService=(cov_2g1bbvxhs().s[2]++,new RoyaltyService());class SongService{constructor(){cov_2g1bbvxhs().f[0]++;cov_2g1bbvxhs().s[3]++;this.songRepository=new SongRepository();// Dependency Injection
}async uploadSong(songData,artistName,songName){cov_2g1bbvxhs().f[1]++;const song=(cov_2g1bbvxhs().s[4]++,await this.songRepository.createSong(songData));// Add song to artist's songs
cov_2g1bbvxhs().s[5]++;await this.songRepository.addSongToArtist(song.artistId,song._id);// Generate royalty and create entry
const royaltyId=(cov_2g1bbvxhs().s[6]++,`${artistName}-${songName.toLowerCase().replace(/\s+/g,'-')}`);const newRoyalty=(cov_2g1bbvxhs().s[7]++,await royaltyService.createRoyalty({royaltyId,artistId:song.artistId,songId:song._id}));cov_2g1bbvxhs().s[8]++;return{song,newRoyalty};}async getSongById(songId){cov_2g1bbvxhs().f[2]++;cov_2g1bbvxhs().s[9]++;return await this.songRepository.findSongById(songId);}async getSongsByArtistId(artistId){cov_2g1bbvxhs().f[3]++;cov_2g1bbvxhs().s[10]++;return await this.songRepository.findSongsByArtistId(artistId);}async getSongsBySongId(songId){cov_2g1bbvxhs().f[4]++;cov_2g1bbvxhs().s[11]++;return await this.songRepository.findSongsBySongId(songId);}async updateSong(songId,updateData){cov_2g1bbvxhs().f[5]++;cov_2g1bbvxhs().s[12]++;return await this.songRepository.modifySong(songId,updateData);}async deleteSong(songId){cov_2g1bbvxhs().f[6]++;// Get the song before deletion to ensure it's removed from Artist and Royalty
const song=(cov_2g1bbvxhs().s[13]++,await this.songRepository.findSongById(songId));cov_2g1bbvxhs().s[14]++;if(!song){cov_2g1bbvxhs().b[0][0]++;cov_2g1bbvxhs().s[15]++;throw new Error('Song not found');}else{cov_2g1bbvxhs().b[0][1]++;}const artistId=(cov_2g1bbvxhs().s[16]++,song.artistId);// Remove song from artist and delete royalty
const removedArtist=(cov_2g1bbvxhs().s[17]++,await this.songRepository.removeSongFromArtist(song.artistId,song._id));const deletedroyalty=(cov_2g1bbvxhs().s[18]++,await this.songRepository.deleteRoyalty(song._id));cov_2g1bbvxhs().s[19]++;return await this.songRepository.removeSong(songId);}}cov_2g1bbvxhs().s[20]++;module.exports=SongService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMmcxYmJ2eGhzIiwiYWN0dWFsQ292ZXJhZ2UiLCJTb25nUmVwb3NpdG9yeSIsInMiLCJyZXF1aXJlIiwiUm95YWx0eVNlcnZpY2UiLCJyb3lhbHR5U2VydmljZSIsIlNvbmdTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJmIiwic29uZ1JlcG9zaXRvcnkiLCJ1cGxvYWRTb25nIiwic29uZ0RhdGEiLCJhcnRpc3ROYW1lIiwic29uZ05hbWUiLCJzb25nIiwiY3JlYXRlU29uZyIsImFkZFNvbmdUb0FydGlzdCIsImFydGlzdElkIiwiX2lkIiwicm95YWx0eUlkIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwibmV3Um95YWx0eSIsImNyZWF0ZVJveWFsdHkiLCJzb25nSWQiLCJnZXRTb25nQnlJZCIsImZpbmRTb25nQnlJZCIsImdldFNvbmdzQnlBcnRpc3RJZCIsImZpbmRTb25nc0J5QXJ0aXN0SWQiLCJnZXRTb25nc0J5U29uZ0lkIiwiZmluZFNvbmdzQnlTb25nSWQiLCJ1cGRhdGVTb25nIiwidXBkYXRlRGF0YSIsIm1vZGlmeVNvbmciLCJkZWxldGVTb25nIiwiYiIsIkVycm9yIiwicmVtb3ZlZEFydGlzdCIsInJlbW92ZVNvbmdGcm9tQXJ0aXN0IiwiZGVsZXRlZHJveWFsdHkiLCJkZWxldGVSb3lhbHR5IiwicmVtb3ZlU29uZyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJzb25nU2VydmljZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTb25nUmVwb3NpdG9yeSA9IHJlcXVpcmUoJy4uL3JlcG9zaXRvcmllcy9zb25nUmVwb3NpdG9yeScpO1xyXG5jb25zdCBSb3lhbHR5U2VydmljZT0gcmVxdWlyZSgnLi4vc2VydmljZXMvcm95YWx0eVNlcnZpY2UnKTtcclxuXHJcbmNvbnN0IHJveWFsdHlTZXJ2aWNlID0gbmV3IFJveWFsdHlTZXJ2aWNlKCk7XHJcblxyXG5jbGFzcyBTb25nU2VydmljZSB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLnNvbmdSZXBvc2l0b3J5ID0gbmV3IFNvbmdSZXBvc2l0b3J5KCk7IC8vIERlcGVuZGVuY3kgSW5qZWN0aW9uXHJcbiAgfVxyXG4gIGFzeW5jIHVwbG9hZFNvbmcoc29uZ0RhdGEsIGFydGlzdE5hbWUsIHNvbmdOYW1lKSB7XHJcbiAgICBjb25zdCBzb25nID0gYXdhaXQgdGhpcy5zb25nUmVwb3NpdG9yeS5jcmVhdGVTb25nKHNvbmdEYXRhKTtcclxuICAgIC8vIEFkZCBzb25nIHRvIGFydGlzdCdzIHNvbmdzXHJcbiAgICBhd2FpdCB0aGlzLnNvbmdSZXBvc2l0b3J5LmFkZFNvbmdUb0FydGlzdChzb25nLmFydGlzdElkLCBzb25nLl9pZCk7XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgcm95YWx0eSBhbmQgY3JlYXRlIGVudHJ5XHJcbiAgICBjb25zdCByb3lhbHR5SWQgPSBgJHthcnRpc3ROYW1lfS0ke3NvbmdOYW1lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzKy9nLCAnLScpfWA7XHJcbiAgICBjb25zdCBuZXdSb3lhbHR5ID0gYXdhaXQgcm95YWx0eVNlcnZpY2UuY3JlYXRlUm95YWx0eSh7IHJveWFsdHlJZCwgYXJ0aXN0SWQ6IHNvbmcuYXJ0aXN0SWQsIHNvbmdJZDogc29uZy5faWQgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiB7IHNvbmcsIG5ld1JveWFsdHkgfTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFNvbmdCeUlkKHNvbmdJZCkge1xyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuc29uZ1JlcG9zaXRvcnkuZmluZFNvbmdCeUlkKHNvbmdJZCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRTb25nc0J5QXJ0aXN0SWQoYXJ0aXN0SWQpIHtcclxuICAgIHJldHVybiBhd2FpdCB0aGlzLnNvbmdSZXBvc2l0b3J5LmZpbmRTb25nc0J5QXJ0aXN0SWQoYXJ0aXN0SWQpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0U29uZ3NCeVNvbmdJZChzb25nSWQpIHtcclxuICAgIHJldHVybiBhd2FpdCB0aGlzLnNvbmdSZXBvc2l0b3J5LmZpbmRTb25nc0J5U29uZ0lkKHNvbmdJZCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyB1cGRhdGVTb25nKHNvbmdJZCwgdXBkYXRlRGF0YSkge1xyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuc29uZ1JlcG9zaXRvcnkubW9kaWZ5U29uZyhzb25nSWQsIHVwZGF0ZURhdGEpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZGVsZXRlU29uZyhzb25nSWQpIHtcclxuICAgIC8vIEdldCB0aGUgc29uZyBiZWZvcmUgZGVsZXRpb24gdG8gZW5zdXJlIGl0J3MgcmVtb3ZlZCBmcm9tIEFydGlzdCBhbmQgUm95YWx0eVxyXG4gICAgY29uc3Qgc29uZyA9IGF3YWl0IHRoaXMuc29uZ1JlcG9zaXRvcnkuZmluZFNvbmdCeUlkKHNvbmdJZCk7XHJcbiAgICBpZiAoIXNvbmcpIHRocm93IG5ldyBFcnJvcignU29uZyBub3QgZm91bmQnKTtcclxuXHJcbiAgICBjb25zdCBhcnRpc3RJZCA9IHNvbmcuYXJ0aXN0SWQ7XHJcbiAgICAvLyBSZW1vdmUgc29uZyBmcm9tIGFydGlzdCBhbmQgZGVsZXRlIHJveWFsdHlcclxuICAgIGNvbnN0IHJlbW92ZWRBcnRpc3Q9YXdhaXQgdGhpcy5zb25nUmVwb3NpdG9yeS5yZW1vdmVTb25nRnJvbUFydGlzdChzb25nLmFydGlzdElkLCBzb25nLl9pZCk7XHJcblxyXG4gICAgY29uc3QgZGVsZXRlZHJveWFsdHk9YXdhaXQgdGhpcy5zb25nUmVwb3NpdG9yeS5kZWxldGVSb3lhbHR5KHNvbmcuX2lkKTtcclxuXHJcbiAgICBcclxuICAgIHJldHVybiBhd2FpdCB0aGlzLnNvbmdSZXBvc2l0b3J5LnJlbW92ZVNvbmcoc29uZ0lkKTtcclxuICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gU29uZ1NlcnZpY2U7XHJcbiJdLCJtYXBwaW5ncyI6InNxR0FlWTtBQUFBQSxhQUFBLFNBQUFBLENBQUEsU0FBQUMs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