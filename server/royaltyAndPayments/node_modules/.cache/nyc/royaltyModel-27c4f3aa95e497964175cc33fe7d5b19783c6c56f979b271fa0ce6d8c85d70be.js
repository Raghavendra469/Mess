function cov_2pghsa0pot(){var path="C:\\final project all things done\\server\\royaltyAndPayments\\models\\royaltyModel.js";var hash="98d6acc589710f7f3771583798ea20e5bc9771d2";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\final project all things done\\server\\royaltyAndPayments\\models\\royaltyModel.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:36}},"1":{start:{line:2,column:16},end:{line:2,column:49}},"2":{start:{line:3,column:13},end:{line:3,column:43}},"3":{start:{line:5,column:22},end:{line:15,column:2}},"4":{start:{line:18,column:0},end:{line:33,column:5}},"5":{start:{line:19,column:4},end:{line:31,column:5}},"6":{start:{line:20,column:6},end:{line:30,column:7}},"7":{start:{line:21,column:8},end:{line:26,column:10}},"8":{start:{line:32,column:4},end:{line:32,column:11}},"9":{start:{line:36,column:0},end:{line:36,column:69}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:18,column:26},end:{line:18,column:27}},loc:{start:{line:18,column:48},end:{line:33,column:3}},line:18}},branchMap:{"0":{loc:{start:{line:19,column:4},end:{line:31,column:5}},type:"if",locations:[{start:{line:19,column:4},end:{line:31,column:5}},{start:{line:undefined,column:undefined},end:{line:undefined,column:undefined}}],line:19}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},f:{"0":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"98d6acc589710f7f3771583798ea20e5bc9771d2"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2pghsa0pot=function(){return actualCoverage;};}return actualCoverage;}cov_2pghsa0pot();const mongoose=(cov_2pghsa0pot().s[0]++,require('mongoose'));const Royalty=(cov_2pghsa0pot().s[1]++,require('../models/royaltyModel'));const Song=(cov_2pghsa0pot().s[2]++,require('../models/songModel'));const RoyaltySchema=(cov_2pghsa0pot().s[3]++,new mongoose.Schema({royaltyId:{type:String,required:true,unique:true},// e.g., "venu-krithik"
artistId:{type:mongoose.Schema.Types.ObjectId,ref:'Artist',required:true},songId:{type:mongoose.Schema.Types.ObjectId,ref:'Song',required:true},period:{type:String,default:Date.now},// e.g., "January 2025"
totalRoyalty:{type:Number,default:0},royaltyDue:{type:Number,default:0},royaltyPaid:{type:Number,default:0},totalStreams:{type:Number,default:0},// Streams counter
calculated_date:{type:Date,default:Date.now}// Last updated timestamp
}));cov_2pghsa0pot().s[4]++;RoyaltySchema.pre("save",async function(next){cov_2pghsa0pot().f[0]++;cov_2pghsa0pot().s[5]++;if(this.isModified("totalRoyalty")){cov_2pghsa0pot().b[0][0]++;cov_2pghsa0pot().s[6]++;// Check if totalRoyalty is changed
try{cov_2pghsa0pot().s[7]++;await Song.updateMany({_id:this.songId},// Use the formatted artistId (e.g., "venu-krithik")
{$set:{totalRoyalty:this.totalRoyalty}},// Sync totalRoyalty with Royalty module
{$set:{totalStreams:this.totalStreams}});}catch(error){}}else{cov_2pghsa0pot().b[0][1]++;}cov_2pghsa0pot().s[8]++;next();});cov_2pghsa0pot().s[9]++;module.exports=mongoose.model('Royalty',RoyaltySchema,'Royalty');
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMnBnaHNhMHBvdCIsImFjdHVhbENvdmVyYWdlIiwibW9uZ29vc2UiLCJzIiwicmVxdWlyZSIsIlJveWFsdHkiLCJTb25nIiwiUm95YWx0eVNjaGVtYSIsIlNjaGVtYSIsInJveWFsdHlJZCIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsInVuaXF1ZSIsImFydGlzdElkIiwiVHlwZXMiLCJPYmplY3RJZCIsInJlZiIsInNvbmdJZCIsInBlcmlvZCIsImRlZmF1bHQiLCJEYXRlIiwibm93IiwidG90YWxSb3lhbHR5IiwiTnVtYmVyIiwicm95YWx0eUR1ZSIsInJveWFsdHlQYWlkIiwidG90YWxTdHJlYW1zIiwiY2FsY3VsYXRlZF9kYXRlIiwicHJlIiwibmV4dCIsImYiLCJpc01vZGlmaWVkIiwiYiIsInVwZGF0ZU1hbnkiLCJfaWQiLCIkc2V0IiwiZXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIiwibW9kZWwiXSwic291cmNlcyI6WyJyb3lhbHR5TW9kZWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xyXG5jb25zdCBSb3lhbHR5ID0gcmVxdWlyZSgnLi4vbW9kZWxzL3JveWFsdHlNb2RlbCcpO1xyXG5jb25zdCBTb25nID0gcmVxdWlyZSgnLi4vbW9kZWxzL3NvbmdNb2RlbCcpO1xyXG5cclxuY29uc3QgUm95YWx0eVNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoe1xyXG4gICAgcm95YWx0eUlkOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUsIHVuaXF1ZTogdHJ1ZSB9LCAvLyBlLmcuLCBcInZlbnUta3JpdGhpa1wiXHJcbiAgICBhcnRpc3RJZDogeyB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsIHJlZjogJ0FydGlzdCcsIHJlcXVpcmVkOiB0cnVlIH0sXHJcbiAgICBzb25nSWQ6IHsgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLCByZWY6ICdTb25nJywgcmVxdWlyZWQ6IHRydWUgfSxcclxuICAgIHBlcmlvZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6IERhdGUubm93IH0sIC8vIGUuZy4sIFwiSmFudWFyeSAyMDI1XCJcclxuICAgIHRvdGFsUm95YWx0eTogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcclxuICAgIHJveWFsdHlEdWU6IHsgdHlwZTogTnVtYmVyLCBkZWZhdWx0OiAwIH0sXHJcbiAgICByb3lhbHR5UGFpZDogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcclxuICAgIHRvdGFsU3RyZWFtczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSwgLy8gU3RyZWFtcyBjb3VudGVyXHJcbiAgICBjYWxjdWxhdGVkX2RhdGU6IHsgdHlwZTogRGF0ZSwgZGVmYXVsdDogRGF0ZS5ub3cgfSAvLyBMYXN0IHVwZGF0ZWQgdGltZXN0YW1wXHJcbn0pO1xyXG5cclxuXHJcblJveWFsdHlTY2hlbWEucHJlKFwic2F2ZVwiLCBhc3luYyBmdW5jdGlvbiAobmV4dCkge1xyXG4gICAgaWYgKHRoaXMuaXNNb2RpZmllZChcInRvdGFsUm95YWx0eVwiKSkgeyAvLyBDaGVjayBpZiB0b3RhbFJveWFsdHkgaXMgY2hhbmdlZFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IFNvbmcudXBkYXRlTWFueShcclxuICAgICAgICAgIHsgX2lkOiB0aGlzLnNvbmdJZCB9LCAvLyBVc2UgdGhlIGZvcm1hdHRlZCBhcnRpc3RJZCAoZS5nLiwgXCJ2ZW51LWtyaXRoaWtcIilcclxuICAgICAgICAgIHsgJHNldDogeyB0b3RhbFJveWFsdHk6IHRoaXMudG90YWxSb3lhbHR5IH0gfSwgLy8gU3luYyB0b3RhbFJveWFsdHkgd2l0aCBSb3lhbHR5IG1vZHVsZVxyXG4gICAgICAgICAgeyAkc2V0OiB7IHRvdGFsU3RyZWFtczogdGhpcy50b3RhbFN0cmVhbXMgfSB9XHJcbiAgICAgICAgICBcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBuZXh0KCk7XHJcbiAgfSk7XHJcbiAgXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG1vbmdvb3NlLm1vZGVsKCdSb3lhbHR5JywgUm95YWx0eVNjaGVtYSwgJ1JveWFsdHknKTsiXSwibWFwcGluZ3MiOiJnbkRBZVk7QUFBQUEsY0FBQSxTQUFBQSxDQUFBLFNBQUFDLGNBQUEsV0FBQUEsY0FBQSxFQUFBRCxjQUFBLEdBZlosS0FBTSxDQUFBRSxRQUFRLEVBQUFGLGNBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQ3BDLEtBQU0sQ0FBQUMsT0FBTyxFQUFBTCxjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLHdCQUF3QixDQUFDLEVBQ2pELEtBQU0sQ0FBQUUsSUFBSSxFQUFBTixjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLHFCQUFxQixDQUFDLEVBRTNDLEtBQU0sQ0FBQUcsYUFBYSxFQUFBUCxjQUFBLEdBQUFHLENBQUEsTUFBRyxHQUFJLENBQUFELFFBQVEsQ0FBQ00sTUFBTSxDQUFDLENBQ3RDQyxTQUFTLENBQUUsQ0FBRUMsSUFBSSxDQUFFQyxNQUFNLENBQUVDLFFBQVEsQ0FBRSxJQUFJLENBQUVDLE1BQU0sQ0FBRSxJQUFLLENBQUMsQ0FBRTtBQUMzREMsUUFBUSxDQUFFLENBQUVKLElBQUksQ0FBRVIsUUFBUSxDQUFDTSxNQUFNLENBQUNPLEtBQUssQ0FBQ0MsUUFBUSxDQUFFQyxHQUFHLENBQUUsUUFBUSxDQUFFTCxRQUFRLENBQUUsSUFBSyxDQUFDLENBQ2pGTSxNQUFNLENBQUUsQ0FBRVIsSUFBSSxDQUFFUixRQUFRLENBQUNNLE1BQU0sQ0FBQ08sS0FBSyxDQUFDQyxRQUFRLENBQUVDLEdBQUcsQ0FBRSxNQUFNLENBQUVMLFFBQVEsQ0FBRSxJQUFLLENBQUMsQ0FDN0VPLE1BQU0sQ0FBRSxDQUFFVCxJQUFJLENBQUVDLE1BQU0sQ0FBRVMsT0FBTyxDQUFFQyxJQUFJLENBQUNDLEdBQUksQ0FBQyxDQUFFO0FBQzdDQyxZQUFZLENBQUUsQ0FBRWIsSUFBSSxDQUFFYyxNQUFNLENBQUVKLE9BQU8sQ0FBRSxDQUFFLENBQUMsQ0FDMUNLLFVBQVUsQ0FBRSxDQUFFZixJQUFJLENBQUVjLE1BQU0sQ0FBRUosT0FBTyxDQUFFLENBQUUsQ0FBQyxDQUN4Q00sV0FBVyxDQUFFLENBQUVoQixJQUFJLENBQUVjLE1BQU0sQ0FBRUosT0FBTyxDQUFFLENBQUUsQ0FBQyxDQUN6Q08sWUFBWSxDQUFFLENBQUVqQixJQUFJLENBQUVjLE1BQU0sQ0FBRUosT0FBTyxDQUFFLENBQUUsQ0FBQyxDQUFFO0FBQzVDUSxlQUFlLENBQUUsQ0FBRWxCLElBQUksQ0FBRVcsSUFBSSxDQUFFRCxPQUFPLENBQUVDLElBQUksQ0FBQ0MsR0FBSSxDQUFFO0FBQ3ZELENBQUMsQ0FBQyxFQUFDdEIsY0FBQSxHQUFBRyxDQUFBLE1BR0hJLGFBQWEsQ0FBQ3NCLEdBQUcsQ0FBQyxNQUFNLENBQUUsZUFBZ0JDLElBQUksQ0FBRSxDQUFBOUIsY0FBQSxHQUFBK0IsQ0FBQSxNQUFBL0IsY0FBQSxHQUFBRyxDQUFBLE1BQzVDLEdBQUksSUFBSSxDQUFDNkIsVUFBVSxDQUFDLGNBQWMsQ0FBQyxDQUFFLENBQUFoQyxjQUFBLEdBQUFpQyxDQUFBLFNBQUFqQyxjQUFBLEdBQUFHLENBQUEsTUFBRTtBQUNyQyxHQUFJLENBQUFILGNBQUEsR0FBQUcsQ0FBQSxNQUNGLEtBQU0sQ0FBQUcsSUFBSSxDQUFDNEIsVUFBVSxDQUNuQixDQUFFQyxHQUFHLENBQUUsSUFBSSxDQUFDakIsTUFBTyxDQUFDLENBQUU7QUFDdEIsQ0FBRWtCLElBQUksQ0FBRSxDQUFFYixZQUFZLENBQUUsSUFBSSxDQUFDQSxZQUFhLENBQUUsQ0FBQyxDQUFFO0FBQy9DLENBQUVhLElBQUksQ0FBRSxDQUFFVCxZQUFZLENBQUUsSUFBSSxDQUFDQSxZQUFhLENBQUUsQ0FFOUMsQ0FBQyxDQUVILENBQUUsTUFBT1UsS0FBSyxDQUFFLENBRWhCLENBQ0YsQ0FBQyxLQUFBckMsY0FBQSxHQUFBaUMsQ0FBQSxVQUFBakMsY0FBQSxHQUFBRyxDQUFBLE1BQ0QyQixJQUFJLENBQUMsQ0FBQyxDQUNSLENBQUMsQ0FBQyxDQUFDOUIsY0FBQSxHQUFBRyxDQUFBLE1BR0xtQyxNQUFNLENBQUNDLE9BQU8sQ0FBR3JDLFFBQVEsQ0FBQ3NDLEtBQUssQ0FBQyxTQUFTLENBQUVqQyxhQUFhLENBQUUsU0FBUyxDQUFDIiwiaWdub3JlTGlzdCI6W119